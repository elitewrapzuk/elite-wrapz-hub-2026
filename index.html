<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ELITE HUB | Infinite Master</title>
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@700&family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --elite-green: #01fabf;
            --bg: #050505;
            --glass: rgba(10, 10, 10, 0.95);
            --border: rgba(1, 250, 191, 0.15);
            --vault-red: #ff3e3e;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: var(--bg); color: #fff; font-family: 'Outfit', sans-serif; height: 100vh; width: 100vw; overflow: hidden; }

        /* --- HUD --- */
        .top-bar { position: fixed; top: 0; width: 100%; padding: 40px 60px; display: grid; grid-template-columns: 1fr 1fr 1fr; align-items: center; z-index: 10000; pointer-events: none; }
        .top-bar > * { pointer-events: auto; }
        #time { font-family: 'Syncopate'; font-size: 2.2rem; color: var(--elite-green); display: flex; align-items: baseline; text-shadow: 0 0 25px rgba(1, 250, 191, 0.4); }
        #time span { font-size: 1rem; opacity: 0.4; margin-left: 8px; width: 35px; display: inline-block; font-variant-numeric: tabular-nums; }
        .center-wing { display: flex; justify-content: center; }
        .brand-link { text-decoration: none; font-family: 'Syncopate'; font-size: 0.95rem; letter-spacing: 4px; color: #fff; transition: 0.4s; text-align: center; white-space: nowrap; }
        .brand-link span { color: var(--elite-green); }
        .brand-link:hover { letter-spacing: 10px; text-shadow: 0 0 12px rgba(1, 250, 191, 0.5); }
        .right-wing { display: flex; align-items: center; justify-content: flex-end; gap: 40px; }
        .hud-search-wrap { border-bottom: 1px solid rgba(1, 250, 191, 0.2); width: 140px; padding: 4px 0; transition: 0.4s; }
        .hud-search-wrap:focus-within { width: 220px; border-bottom-color: var(--elite-green); }
        .hud-search-input { background: transparent; border: none; color: var(--elite-green); font-family: 'Syncopate'; font-size: 0.6rem; outline: none; width: 100%; letter-spacing: 2px; }
        #date-trigger { font-size: 0.7rem; letter-spacing: 2px; opacity: 0.5; cursor: pointer; transition: 0.3s; text-transform: uppercase; font-weight: 600; }
        #date-trigger:hover { opacity: 1; color: var(--elite-green); }

        /* --- CANVAS --- */
        #viewport { width: 100vw; height: 100vh; overflow: hidden; position: relative; background-image: radial-gradient(rgba(1, 250, 191, 0.12) 1.5px, transparent 1.5px); background-size: 30px 30px; cursor: grab; }
        #canvas { position: absolute; top: 0; left: 0; width: 1px; height: 1px; transform-origin: 0 0; will-change: transform; }

        /* --- STICKIES --- */
        .floating-card { position: absolute; background: var(--glass); border: 1px solid var(--border); border-radius: 8px; backdrop-filter: blur(25px); display: flex; flex-direction: column; overflow: hidden; resize: both; min-width: 180px; min-height: 100px; cursor: grab; box-shadow: 0 10px 40px rgba(0,0,0,0.6); }
        .card-header { padding: 14px 18px; background: rgba(1, 250, 191, 0.05); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; width: 100%; overflow: hidden; }
        .header-title-input { background: transparent; border: none; color: var(--elite-green); font-family: 'Syncopate'; font-size: 0.75rem; font-weight: 700; outline: none; text-transform: uppercase; flex: 1; min-width: 0; margin-right: 10px; }
        .header-btn-group { display: flex; gap: 12px; align-items: center; flex-shrink: 0; }

        .delete-dot { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; border-radius: 50%; cursor: pointer; transition: 0.2s; position: relative; }
        .delete-dot::before { content: ""; width: 5px; height: 5px; background: rgba(255,255,255,0.3); border-radius: 50%; transition: 0.2s; position: absolute; }
        .delete-dot span { font-size: 0.75rem; color: var(--vault-red); opacity: 0; transition: 0.2s; transform: scale(0.4); font-weight: bold; pointer-events: none; }
        .delete-dot:hover::before { opacity: 0; transform: scale(0); }
        .delete-dot:hover span { opacity: 1; transform: scale(1); }

        .link-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 18px; border-bottom: 1px solid rgba(255,255,255,0.02); transition: 0.2s; }
        .link-item:hover { background: rgba(1, 250, 191, 0.05); }
        .link-item a { color: #888; text-decoration: none; font-size: 0.85rem; flex: 1; transition: 0.2s; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .link-item a:hover { color: var(--elite-green); }

        /* --- OVERLAYS --- */
        .overlay-screen { position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 110000; display: none; flex-direction: column; align-items: center; justify-content: center; backdrop-filter: blur(25px); }
        .dot-auth { width: 60px; height: 70px; border: 1px solid #222; display: flex; align-items: center; justify-content: center; color: var(--elite-green); font-family: 'Syncopate'; border-radius: 6px; font-size: 1.5rem; }
        .dot-auth.filled { border-color: var(--elite-green); box-shadow: 0 0 20px rgba(1, 250, 191, 0.4); }
        
        .vault-label { font-size: 0.7rem; color: #555; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px; }
        .vault-value { font-family: 'Syncopate'; font-size: 1rem; color: #fff; letter-spacing: 1px; }

        .master-controls { position: fixed; bottom: 35px; left: 50%; transform: translateX(-50%); display: flex; gap: 15px; z-index: 10000; background: rgba(0,0,0,0.5); padding: 10px; border-radius: 8px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.05); }
        .ctrl-btn { padding: 12px 20px; background: rgba(15, 15, 15, 0.9); border: 1px solid rgba(255, 255, 255, 0.05); color: #777; border-radius: 4px; font-family: 'Outfit'; font-size: 0.65rem; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .ctrl-btn:hover { color: var(--elite-green); border-color: var(--elite-green); }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="left-wing"><div id="time">00:00<span>00</span></div></div>
        <div class="center-wing"><a href="https://www.elitewrapz.uk" target="_blank" class="brand-link">ELITE <span>WRAPZ</span></a></div>
        <div class="right-wing">
            <div class="hud-search-wrap"><input type="text" class="hud-search-input" id="global-search" placeholder="SEARCH..." onkeydown="executeSearch(event)"></div>
            <div style="position:relative;">
                <div id="date-trigger" onclick="toggleCalendar(event)">DATE_LOADING</div>
                <div id="calendar-popup" style="position:absolute; top:45px; right:0; background:#080808; border:1px solid var(--border); border-radius:8px; padding:20px; width:280px; display:none; flex-direction:column; z-index:5000;">
                    <div class="cal-header" style="display:flex; justify-content:space-between; margin-bottom:20px; font-family:'Syncopate'; font-size:0.5rem; color:var(--elite-green);">
                        <span style="cursor:pointer" onclick="changeMonth(-1, event)">â€¹</span>
                        <span id="cal-month-year"></span>
                        <span style="cursor:pointer" onclick="changeMonth(1, event)">â€º</span>
                    </div>
                    <div class="cal-grid" id="cal-grid" style="display:grid; grid-template-columns:repeat(7,1fr); gap:6px; text-align:center; font-size:0.75rem;"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="viewport"><div id="canvas"></div></div>

    <div id="auth-screen" class="overlay-screen">
        <div id="auth-msg" style="font-family:'Syncopate'; font-size:0.6rem; color:var(--elite-green); letter-spacing:5px; margin-bottom:40px;">ENCRYPTED_SIGNAL_REQUIRED</div>
        <div style="display:flex; gap:15px;"><div class="dot-auth"></div><div class="dot-auth"></div><div class="dot-auth"></div><div class="dot-auth"></div><div class="dot-auth"></div><div class="dot-auth"></div></div>
    </div>

    <div id="vault-overlay" class="overlay-screen">
        <div style="width:550px; background:#080808; border:1px solid #1a1a1a; padding:40px; border-top:3px solid var(--vault-red);">
            <div style="font-family:'Syncopate'; font-size:0.6rem; color:var(--vault-red); letter-spacing:4px; margin-bottom:25px;">RESTRICTED_ASSETS</div>
            <div id="vault-items"></div>
            <div style="display:flex; gap:12px; margin-top:30px; border-top:1px solid #1a1a1a; padding-top:25px;">
                <button class="ctrl-btn" onclick="promptVaultAdd()">+ New Secret</button>
                <button class="ctrl-btn" onclick="closeVault()" style="color:var(--vault-red)">Lock</button>
            </div>
        </div>
    </div>

    <div class="master-controls">
        <button class="ctrl-btn" onclick="spawnCategory()">+ List</button>
        <button class="ctrl-btn" onclick="spawnNote()">+ Note</button>
        <button class="ctrl-btn" onclick="triggerAuth()">ðŸ”’ Vault</button>
        <button class="ctrl-btn" onclick="exportData()">ðŸ’¾ Export</button>
        <button class="ctrl-btn" onclick="importData()">ðŸ“‚ Import</button>
        <button class="ctrl-btn" onclick="resetView()">Center</button>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('eliteHubV28')) || { 
            categories: [], 
            notes: [], 
            vault: [{l:'Gateway ID', v:'54 02 69 02 45 51'}, {l:'EORI Number', v:'GB045268219000'}] 
        };
        const PASSCODE = "990704";
        let inputBuffer = "", scale = 1, posX = 100, posY = 100, isPanning = false, startX, startY;
        let currentCalDate = new Date();

        function init() { render(); updateClock(); setInterval(updateClock, 1000); renderCalendar(); setupNavigation(); applyTransform(); }

        function setupNavigation() {
            const vp = document.getElementById('viewport');
            vp.onmousedown = (e) => { if (e.target === vp) { isPanning = true; startX = e.clientX - posX; startY = e.clientY - posY; } };
            window.onmousemove = (e) => { if (isPanning) { posX = e.clientX - startX; posY = e.clientY - startY; applyTransform(); } };
            window.onmouseup = () => isPanning = false;
            vp.onwheel = (e) => {
                e.preventDefault();
                const zoom = e.deltaY > 0 ? 0.9 : 1.1;
                const newScale = Math.min(Math.max(0.15, scale * zoom), 3);
                const rect = vp.getBoundingClientRect();
                const mx = e.clientX - rect.left, my = e.clientY - rect.top;
                posX -= (mx - posX) * (newScale / scale - 1);
                posY -= (my - posY) * (newScale / scale - 1);
                scale = newScale; applyTransform();
            };
        }

        function applyTransform() { 
            document.getElementById('canvas').style.transform = `translate(${posX}px, ${posY}px) scale(${scale})`;
            document.getElementById('viewport').style.backgroundPosition = `${posX}px ${posY}px`;
        }

        // --- DATA MGMT ---
        function exportData() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(db));
            const dl = document.createElement('a');
            dl.setAttribute("href", dataStr);
            dl.setAttribute("download", `ELITE_HUB_${new Date().toLocaleDateString().replace(/\//g,'-')}.json`);
            document.body.appendChild(dl); dl.click(); dl.remove();
        }

        function importData() {
            const inp = document.createElement('input'); inp.type = 'file'; inp.accept = '.json';
            inp.onchange = e => {
                const f = e.target.files[0];
                const r = new FileReader();
                r.onload = ev => {
                    try {
                        const content = JSON.parse(ev.target.result);
                        if (content.categories && content.notes) {
                            db = content; save(); render(); alert("SYSTEM_RESTORE_COMPLETE");
                        }
                    } catch (err) { alert("DATA_CORRUPT"); }
                }
                r.readAsText(f);
            };
            inp.click();
        }

        function triggerAuth() { inputBuffer = ""; updateAuthDots(); document.getElementById('auth-screen').style.display = 'flex'; }
        window.addEventListener('keydown', (e) => {
            if (document.getElementById('auth-screen').style.display === 'flex' && e.key >= '0' && e.key <= '9') {
                inputBuffer += e.key; updateAuthDots();
                if (inputBuffer === PASSCODE) {
                    document.getElementById('auth-screen').style.display = 'none';
                    document.getElementById('vault-overlay').style.display = 'flex';
                    renderVault();
                } else if (inputBuffer.length >= 6) { inputBuffer = ""; setTimeout(updateAuthDots, 500); }
            }
        });

        function updateAuthDots() { document.querySelectorAll('.dot-auth').forEach((d, i) => { d.innerText = i < inputBuffer.length ? "*" : ""; i < inputBuffer.length ? d.classList.add('filled') : d.classList.remove('filled'); }); }

        function renderCalendar() {
            const grid = document.getElementById('cal-grid'); grid.innerHTML = '';
            document.getElementById('cal-month-year').innerText = currentCalDate.toLocaleDateString('en-GB', { month: 'long', year: 'numeric' }).toUpperCase();
            ['M','T','W','T','F','S','S'].forEach(d => grid.innerHTML += `<div style="color:#444; font-size:0.55rem;">${d}</div>`);
            const first = new Date(currentCalDate.getFullYear(), currentCalDate.getMonth(), 1).getDay();
            for(let i=0; i<(first === 0 ? 6 : first - 1); i++) grid.innerHTML += `<div></div>`;
            for(let d=1; d<=new Date(currentCalDate.getFullYear(), currentCalDate.getMonth()+1, 0).getDate(); d++) {
                const isToday = new Date().toDateString() === new Date(currentCalDate.getFullYear(), currentCalDate.getMonth(), d).toDateString();
                grid.innerHTML += `<div style="padding:8px; border-radius:4px; ${isToday ? 'background:var(--elite-green); color:#000;' : ''}">${d}</div>`;
            }
        }
        function toggleCalendar(e) { e.stopPropagation(); const c = document.getElementById('calendar-popup'); c.style.display = (c.style.display === 'flex' ? 'none' : 'flex'); }
        function changeMonth(dir, e) { e.stopPropagation(); currentCalDate.setMonth(currentCalDate.getMonth() + dir); renderCalendar(); }

        function render() {
            const canvas = document.getElementById('canvas'); canvas.innerHTML = '';
            db.categories.forEach((cat, idx) => canvas.appendChild(createCard(cat, idx, 'cat')));
            db.notes.forEach((note, idx) => canvas.appendChild(createCard(note, idx, 'note')));
            save();
        }

        function createCard(obj, idx, type) {
            const el = document.createElement('div'); el.className = 'floating-card';
            el.style.cssText = `left:${obj.x}px; top:${obj.y}px; width:${obj.w}px; height:${obj.h}px; z-index:${obj.z || 1};`;
            el.innerHTML = `
                <div class="card-header">
                    <input class="header-title-input" value="${obj.title}" onchange="updateTitle('${type}', ${idx}, this.value)">
                    <div class="header-btn-group">
                        ${type==='cat' ? `<div onclick="addLinkPrompt(event, ${idx})" style="cursor:pointer; color:#555; font-size:1.2rem;">+</div>` : ''}
                        <div class="delete-dot" onclick="deleteObj(event, '${type}', ${idx})"><span>âœ•</span></div>
                    </div>
                </div>
                <div style="flex-grow:1; overflow:auto;">
                    ${type==='cat' ? (obj.links.map((l,li)=>`
                        <div class="link-item"><a href="${l.u}" target="_blank">${l.n}</a>
                        <div class="delete-dot" onclick="deleteLink(event, ${idx},${li})"><span>âœ•</span></div></div>`).join('')) :
                    `<textarea style="width:100%; height:100%; background:transparent; border:none; color:#bbb; padding:20px; outline:none; resize:none; font-family:'Outfit'; font-size:0.9rem;" oninput="updateNoteText(${idx}, this.value)">${obj.text || ''}</textarea>`}
                </div>`;
            el.onmousedown = (e) => {
                const rect = el.getBoundingClientRect();
                if ((e.clientX > rect.right - 25) && (e.clientY > rect.bottom - 25)) return;
                if (e.target.closest('.delete-dot') || e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.innerText === '+') return;
                bringToFront(el); e.stopPropagation();
                let mx = e.clientX, my = e.clientY;
                document.onmousemove = (mv) => { obj.x += (mv.clientX - mx)/scale; obj.y += (mv.clientY - my)/scale; el.style.left = obj.x+"px"; el.style.top = obj.y+"px"; mx = mv.clientX; my = mv.clientY; };
                document.onmouseup = () => { document.onmousemove = null; save(); };
            };
            new ResizeObserver(() => { obj.w = el.offsetWidth; obj.h = el.offsetHeight; save(); }).observe(el);
            return el;
        }

        function save() { localStorage.setItem('eliteHubV28', JSON.stringify(db)); }
        function updateClock() {
            const now = new Date();
            document.getElementById('time').innerHTML = `${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}<span>${now.getSeconds().toString().padStart(2,'0')}</span>`;
            document.getElementById('date-trigger').innerText = now.toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }).toUpperCase();
        }
        function spawnCategory() { db.categories.push({ title:'LIST', x: 200, y: 200, w:260, h:220, links:[] }); render(); }
        function spawnNote() { db.notes.push({ title:'NOTE', x: 250, y: 250, w:320, h:280, text:'' }); render(); }
        function updateTitle(t,i,v) { if(t==='cat')db.categories[i].title=v; else db.notes[i].title=v; save(); }
        function updateNoteText(i,v) { db.notes[i].text=v; save(); }
        function deleteObj(e, t, i) { e.stopPropagation(); if(t==='cat')db.categories.splice(i,1); else db.notes.splice(i,1); render(); }
        function deleteLink(e, ci, li) { e.stopPropagation(); db.categories[ci].links.splice(li,1); render(); }
        function bringToFront(el) { document.querySelectorAll('.floating-card').forEach(x=>x.style.zIndex=1); el.style.zIndex=100; }
        function resetView() { scale = 1; posX = 100; posY = 100; applyTransform(); }
        function executeSearch(e) { if(e.key === 'Enter') { window.open(`https://www.google.com/search?q=${encodeURIComponent(e.target.value)}`, '_blank'); e.target.value = ''; } }
        
        function renderVault() { 
            document.getElementById('vault-items').innerHTML = db.vault.map(item => `
                <div style="display:flex; justify-content:space-between; align-items:center; padding:20px 0; border-bottom:1px solid #111;">
                    <div>
                        <div class="vault-label">${item.l}</div>
                        <div class="vault-value">${item.v}</div>
                    </div>
                    <button class="ctrl-btn" onclick="navigator.clipboard.writeText('${item.v}')">COPY</button>
                </div>`).join(''); 
        }
        function closeVault() { document.getElementById('vault-overlay').style.display = 'none'; }
        
        function openModal(title, fields, onConfirm) {
            const m = document.createElement('div'); m.className = 'overlay-screen'; m.style.display = 'flex';
            m.innerHTML = `<div style="width:400px; background:#080808; border:1px solid #222; padding:30px; border-top:2px solid var(--elite-green);">
                <div style="font-family:'Syncopate'; font-size:0.6rem; color:var(--elite-green); margin-bottom:20px;">${title}</div>
                ${fields.map(f => `<input id="mf-${f.id}" placeholder="${f.label}" style="width:100%; background:#111; border:1px solid #333; padding:15px; color:#fff; margin-bottom:10px; outline:none;">`).join('')}
                <button class="ctrl-btn" id="m-confirm" style="width:100%;">ADD</button>
            </div>`;
            document.body.appendChild(m);
            document.getElementById('m-confirm').onclick = () => { onConfirm(fields.map(f => document.getElementById(`mf-${f.id}`).value)); m.remove(); };
        }
        function addLinkPrompt(e, i) { e.stopPropagation(); openModal("NEW_LINK", [{id:'n', label:'NAME'}, {id:'u', label:'URL'}], (d) => { if(d[0]&&d[1]) { db.categories[i].links.push({n:d[0], u:d[1]}); render(); } }); }
        
        init();
    </script>
</body>
</html>
